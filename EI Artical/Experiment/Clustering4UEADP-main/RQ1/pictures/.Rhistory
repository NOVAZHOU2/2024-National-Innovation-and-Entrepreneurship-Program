library(ScottKnottESD)
library(readxl)
finalpath = "../Result/"
skresultpath = "../output/"
# finalpath= "C:/Users/Andre/Desktop/CUDP-master/discussion/Result_/"
# skresultpath='C:/Users/Andre/Desktop/CUDP-master/discussion/output_/'
file_names<- list.files(finalpath)
print(file_names)
for (i in 1:length(file_names)) {
print(111)
path=paste(finalpath,sep = "",file_names[i])
print(path)
#csv<- read.csv(file=path, header=TRUE, sep=",")
csv<- read_excel(path)
csv<-csv[-1]
sk <- sk_esd(csv)
#plot(sk)
resultpath=paste(skresultpath,sep = "",file_names[i])
resultpath=paste(resultpath,sep = "",".txt")
print(resultpath)
write.table (sk[["groups"]], resultpath)
print(222)
}
library(ScottKnottESD)
library(readxl)
# 同样要记得换工作路径
finalpath= "D:/Desktop/Clustering4UEADP-main/Clustering4UEADP-main/RQ1/DrawPicData/"
skresultpath='D:/Desktop/Clustering4UEADP-main/Clustering4UEADP-main/RQ1/output/'
file_names<- list.files(finalpath)
for (i in 1:length(file_names)) {
print(path)
path=paste(finalpath,sep = "",file_names[i])
#csv<- read.csv(file=path, header=TRUE, sep=",")
csv<- read_excel(path)
csv<-csv[-1]
sk <- sk_esd(csv)
#可能是我数据不够，导致我跑这里的时候，如果出现一列数据全是一样的，会报错，我就寄在这了
#plot(sk)
resultpath=paste(skresultpath,sep = "",file_names[i])
resultpath=paste(resultpath,sep = "",".txt")
print(resultpath)
write.table (sk[["groups"]], resultpath)
}
library(ScottKnottESD)
library(readxl)
finalpath= 'D:/Desktop/Clustering4UEADP-main/Clustering4UEADP-main/RQ1/DrawPicData/'
#Folder to store sk results
#skresultpath='C:/Users/Andre/Desktop/CUDP-master/discussion/Result/picture_sk/'
# skresultpath = '../picture_sk_new/'
skresultpath = 'D:/Desktop/Clustering4UEADP-main/Clustering4UEADP-main/RQ1/pictures/'
#save picture
setwd(skresultpath)
file_names<- list.files(finalpath)
for (i in 1:length(file_names)) {
#if (grepl(pattern = ".xlsx$",x = file_names[i]) )
if (grepl(pattern = ".xlsx$",x = file_names[i]) )
{
print(file_names[i])
name<-strsplit(file_names[i],split = ".xlsx")[[1]][1]
#print(name)
path=paste(finalpath,sep = "",file_names[i])
print(path)
csv<- read_excel(path)
csv<-csv[-1]
#sk <- sk_esd(csv)
sk <- sk_esd(csv)
#plot(sk)
#par(mar=c(7,1,1,1)+1)
#par(oma=c(7,3,3,3))
future=paste('RQ1_Ranking_',name,sep = "",".jpg")
#jpeg(file=future,width=1960,height=1080)
jpeg(file=future, width=5000,height=2000, units = 'px',res=600)
plot(sk,
mar=c(7,1,1,1),
las=2,
#cex=0.6,
#cex.axis=0.1,
cex.lab=1.2,
xlab = '',
ylab = 'Rankings',
#mgp = c(3,2,0),
#xgap.axis = 3,
#axis.line=3,
family = "serif",
title=NULL
)
dev.off()
resultpath=paste(skresultpath,sep = "",file_names[i])
resultpath=paste(resultpath,sep = "",".txt")
print(resultpath)
#write.table (sk[["groups"]], resultpath)
graphpath = paste(skresultpath,sep = "",file_names[i])
#graphpath = paste(graphpath,sep = "",".jpg")
}
}
